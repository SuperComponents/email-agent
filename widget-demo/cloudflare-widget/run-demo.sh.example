#!/bin/bash

echo "ğŸš€ Starting Cloudflare AI Chat Widget Demo..."

# Install dependencies
echo "ğŸ“¦ Installing dependencies..."
npm install

# Build the widget
echo "ğŸ”¨ Building widget..."
npm run build

# Start backend API in background
echo "ğŸŒ Starting backend API on port 3001..."
npx wrangler dev --port 3001 &
BACKEND_PID=$!

# Start widget server
echo "ğŸ¯ Starting widget server on port 3002..."
npm run serve &
WIDGET_PID=$!

# Wait a moment for servers to start
sleep 2

echo "
âœ… Cloudflare Widget Demo is running!

ğŸŒ Backend API: https://your-domain.com
ğŸ“¦ Widget Server: http://localhost:3002
ğŸ¯ Demo Page: http://localhost:3002/demo.html

Press Ctrl+C to stop all servers.
"

# Wait for Ctrl+C
trap "kill $BACKEND_PID $WIDGET_PID; exit" INT
wait 